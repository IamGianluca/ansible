- name: Pull dwm-flexipatch repository
  ansible.builtin.git:
    repo: 'https://github.com/bakkeby/dwm-flexipatch.git'
    dest: "~/git/dwm-flexipatch"

- name: Install requirements for DWM
  become: true
  ansible.builtin.apt:
    name: ['libx11-dev', 'libxft-dev', 'libxinerama-dev']

- name: Build dwm-flexipatch
  become: true
  command: make clean install 
  args:
    chdir: /home/gianluca/git/dwm-flexipatch

# needed to control and mute volume via XF86 keys
- name: Install PulseAudio
  become: true
  ansible.builtin.apt:
    name: ['pulseaudio']

# needed to control display brightness via XF86 keys
- name: Install brightnessctl
  become: true
  ansible.builtin.apt:
    name: ['brightnessctl']

- name: Register username for following task
  command: whoami
  changed_when: false
  become: false
  register: whoami

- name: Add user to video group to enable changing display brightness without sudo 
  become: true
  ansible.builtin.user:
    name: gianluca
    group: video
